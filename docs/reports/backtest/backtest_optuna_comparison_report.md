# 전략 Optuna 최적화 비교 보고서

**작성일**: 2026-02-20
**작성자**: ptj_stock_lab
**대상 전략**: 상위 5개 신호 전략 × 원본/보수적 파라미터
**분석 기간**: Train 2023-09-01 ~ 2025-12-31 / OOS 2026-01-01 ~ 2026-02-19

---

## 1. 개요

### 1.1 목적

A~L 실험에서 도출된 상위 5개 진입 전략에 대해 두 가지 파라미터 셋으로 백테스트를 비교한다:

- **원본 파라미터**: L 실험에서 사용한 초기 설계값 (target 80%, stop -25%, hold 90일, 3x, pyr3)
- **보수적 Optuna 파라미터**: Exit 파라미터를 제한한 상태에서 신호 조건만 자유 최적화

### 1.2 분석 종목

| 종목 | 설명 | 데이터 기간 |
|------|------|-----------|
| IREN | 아이렌 AI (BTC 채굴, 고베타) | 2023-09-01 ~ 2026-02-18 |
| CONL | 코인베이스 2배 ETF | 2023-09-01 ~ 2026-02-18 |
| PTIR | 팔란티어 2배 ETF | 2024-09-04 ~ 2026-02-18 |

### 1.3 분석 전략

| 전략 ID | 전략명 | L 실험 원본 PnL |
|---------|-------|--------------|
| di_surge | DI크로스+급등 (E챔피언) | 18.9M |
| vix_di_surge | VIX중립+DI급등 | 21.4M |
| macd_vol | MACD+거래량폭발 | 19.8M |
| btc_rsi_e | BTC-RSI+DI복합 | 18.9M |
| strong25_macd | 강추세+MACD+DI | 18.0M |

---

## 2. 파라미터 설정

### 2.1 원본 파라미터 (공통)

| 파라미터 | 값 |
|---------|---|
| target_pct | 80% |
| stop_pct | -25% |
| hold_days | 90일 |
| unit_mul | 3.0x |
| max_pyramid | 3층 |
| pyramid_add_pct | 7% |

### 2.2 보수적 Optuna 파라미터

| 전략 | target | stop | hold | 배율 | pyr | BTC RSI< | VIX 범위 | 핵심 신호 조건 |
|------|--------|------|------|------|-----|---------|---------|------------|
| di_surge | 54.2% | -21.6% | 43일 | 2.9x | 2층 | 76.8 | >18.0 | DI갭>3.6, 급등>2.8% |
| vix_di_surge | 41.2% | -21.6% | 52일 | 2.9x | 3층 | 76.8 | 12~38 | DI갭>10, 급등>2.1%, vol>2.3 |
| macd_vol | 36.3% | -14.0% | 51일 | 2.9x | 3층 | 69.7 | 12~32 | MACD>0, vol>1.4, RSI14>68.8 |
| **btc_rsi_e** | **54.4%** | **-11.0%** | **50일** | **3.0x** | **2층** | **64.6** | **12~35** | **DI갭>7.8, 급등>6.0%, pct_MA20>13%** |
| strong25_macd | 51.9% | -21.0% | 35일 | 2.8x | 3층 | 76.9 | 12~37 | DI갭>7.0, MACD>-0.26, vol>1.2 |

> **특이점**: `btc_rsi_e`의 BTC RSI 상한 64.6 → J 실험 발견(BTC RSI<61)과 가장 일치하는 보수적 최적화 결과

---

## 3. Train 구간 결과 (2023-09-01 ~ 2025-12-31)

### 3.1 전략별 종합 성과

| 전략 | 원본 PnL | 원본 WR | 원본 N | 보수 PnL | 보수 WR | 보수 N | WR 개선 |
|------|---------|---------|--------|---------|---------|--------|--------|
| di_surge | 6,258만원 | 51.9% | 27 | 2,061만원 | **83.3%** | 12 | +31.4%p |
| vix_di_surge | 4,114만원 | 66.7% | 15 | 1,653만원 | **100.0%** | 8 | +33.3%p |
| macd_vol | 5,378만원 | 66.7% | 18 | 2,231만원 | **78.9%** | 19 | +12.2%p |
| **btc_rsi_e** | **5,080만원** | 55.6% | 18 | **2,369만원** | **75.0%** | **24** | +19.4%p |
| strong25_macd | 2,457만원 | 35.0% | 20 | 4,726만원 | 59.5% | 37 | +24.5%p |

> **보수적 파라미터**: Train PnL은 감소하지만 WR이 대폭 개선됨
> **예외**: `strong25_macd`는 보수적 PnL(4,726만원)이 원본(2,457만원)보다 높음 — 낮은 목표치가 많은 거래 완결로 이어짐

### 3.2 종목별 Train 상세 성과

#### di_surge (DI크로스+급등)

| 종목 | 파라미터 | N | WR | avg | PnL |
|------|---------|---|----|----|-----|
| IREN | 원본 | 9 | 66.7% | +43.0% | 2,972만원 |
| IREN | 보수적 | 4 | 75.0% | +21.8% | 355만원 |
| CONL | 원본 | 13 | **30.8%** | +8.0% | 1,143만원 |
| CONL | 보수적 | 3 | **100.0%** | +60.4% | 893만원 |
| PTIR | 원본 | 5 | 80.0% | +57.1% | 2,143만원 |
| PTIR | 보수적 | 5 | 80.0% | +38.6% | 814만원 |

> CONL 원본 WR 30.8%: 13거래 중 4승 — 소수의 대형 수익(+87%, +80%, +94%)이 전체 PnL 견인
> 보수적 파라미터로 CONL WR 100% 달성 (거래수 3건으로 대폭 감소)

#### vix_di_surge (VIX중립+DI급등)

| 종목 | 파라미터 | N | WR | avg | PnL |
|------|---------|---|----|----|-----|
| IREN | 원본 | 6 | 66.7% | +40.7% | 995만원 |
| IREN | 보수적 | 3 | 100.0% | +55.4% | 769만원 |
| CONL | 원본 | 3 | **100.0%** | +107.7% | 2,140만원 |
| CONL | 보수적 | 3 | 100.0% | +48.9% | 509만원 |
| PTIR | 원본 | 6 | 50.0% | +23.2% | 978만원 |
| PTIR | 보수적 | 2 | 100.0% | +46.7% | 376만원 |

> 원본 CONL이 이례적으로 WR 100% + avg 107.7% — 2024-11 BTC 랠리 구간 포착
> 보수적은 거래수 감소로 총 PnL 하락하지만 안정성 향상

#### macd_vol (MACD+거래량폭발)

| 종목 | 파라미터 | N | WR | avg | PnL |
|------|---------|---|----|----|-----|
| IREN | 원본 | 7 | 71.4% | +49.5% | 1,646만원 |
| IREN | 보수적 | 9 | **88.9%** | +24.1% | 1,365만원 |
| CONL | 원본 | 6 | 66.7% | +63.0% | 2,060만원 |
| CONL | 보수적 | 4 | 75.0% | +18.4% | 403만원 |
| PTIR | 원본 | 5 | 80.0% | +56.0% | 1,671만원 |
| PTIR | 보수적 | 6 | 83.3% | +20.3% | 463만원 |

> IREN 보수적: 거래수 증가(7→9) + WR 88.9% — 단기 RSI14>68 진입 전략이 IREN에서 효과적
> CONL 원본: +139.4%, +130.6% 등 대형 수익 포함 (단기적 복리 포착)

#### btc_rsi_e (BTC-RSI+DI복합) ← 추천 전략

| 종목 | 파라미터 | N | WR | avg | PnL |
|------|---------|---|----|----|-----|
| IREN | 원본 | 6 | 83.3% | +53.7% | 2,036만원 |
| IREN | 보수적 | 12 | 75.0% | +23.9% | 1,332만원 |
| CONL | 원본 | 5 | 60.0% | +53.4% | 1,618만원 |
| CONL | 보수적 | 4 | 75.0% | +24.8% | 497만원 |
| PTIR | 원본 | 7 | 42.9% | +23.9% | 1,425만원 |
| PTIR | 보수적 | 8 | 75.0% | +16.8% | 540만원 |

> 보수적 `btc_rsi_e`: IREN/CONL/PTIR 모두 정확히 WR 75% — 일관성이 가장 높은 전략
> 거래수 증가 (18→24): 연간 약 10회, 통계적 유의미한 수준

#### strong25_macd (강추세+MACD+DI)

| 종목 | 파라미터 | N | WR | avg | PnL |
|------|---------|---|----|----|-----|
| IREN | 원본 | 8 | 50.0% | +29.5% | 1,971만원 |
| IREN | 보수적 | 16 | 68.8% | +18.9% | 2,310만원 |
| CONL | 원본 | 8 | **25.0%** | +2.5% | 534만원 |
| CONL | 보수적 | 13 | 46.2% | +12.2% | 1,313만원 |
| PTIR | 원본 | 4 | **25.0%** | -1.7% | -48만원 |
| PTIR | 보수적 | 8 | 62.5% | +19.1% | 1,103만원 |

> 원본 CONL/PTIR WR 25% — 강추세(pct_ma20>25%) 진입이 과열 구간 포착으로 이어져 손실
> 보수적: 진입 기준 완화(pct_ma20>-7.2%)로 더 많은 거래 + WR 개선 (이상하게 보이지만 실제로 효과적)

---

## 4. OOS 구간 결과 (2026-01-01 ~ 2026-02-19)

### 4.1 OOS 시장 환경

2026년 1~2월은 암호화폐/고베타 ETF 전반에 걸친 급락장이었다:

```
IREN:  $42.70 (1/2) → $57.82 (1/16, 고점) → $39.79 (2/18) — 고점 대비 -31%
CONL:  $15.05 (1/2) → $18.45 (1/13, 고점) → $10.50 (2/18) — 고점 대비 -43%
PTIR:  $20.10 (1/2) → $27.71 (1/23, 고점) → $19.10 (2/18) — 고점 대비 -31%
```

> 모든 종목이 **1월 중순 고점 형성 후 급락** — 2025년 4분기 BTC/AI 랠리 종료 후 조정

### 4.2 전략별 OOS 결과

| 전략 | 파라미터 | 거래수 | WR | PnL | 주요 거래 |
|------|---------|-------|----|-----|---------|
| di_surge | 원본 | 1 | 0% | **-87만원** | CONL 1/23 진입 -29.0% |
| di_surge | 보수적 | 0 | - | **0원** | 신호 미발생 |
| vix_di_surge | 원본 | 0 | - | **0원** | 신호 미발생 |
| vix_di_surge | 보수적 | 0 | - | **0원** | 신호 미발생 |
| macd_vol | 원본 | 2 | 0% | **-159만원** | IREN 2/5 -25.6%, CONL 1/30 -27.6% |
| macd_vol | 보수적 | 1 | 0% | **-20만원** | IREN 1/30 -7.1% |
| btc_rsi_e | 원본 | 1 | 0% | **-151만원** | IREN 2/5 -29.6% |
| **btc_rsi_e** | **보수적** | **1** | **0%** | **-16만원** | **IREN 1/30 -5.2%** |
| strong25_macd | 원본 | 1 | 0% | **-171만원** | IREN 2/5 -33.5% |
| strong25_macd | 보수적 | 2 | 0% | **-219만원** | IREN 2/5 -23.7%, CONL 1/20 -21.4% |

### 4.3 OOS 거래 상세

#### OOS에서 실제 발생한 모든 거래

| 날짜 | 종목 | 전략 | 파라미터 | 진입가 | 청산가 | 수익% | 보유일 | 손익 |
|------|------|------|---------|--------|--------|-------|--------|-----|
| 2026-01-20 | CONL | strong25_macd | 보수적 | $18.45 | $14.50 | -21.4% | 15일 | -60만원 |
| 2026-01-23 | CONL | di_surge | 원본 | $18.45 | $13.10 | -29.0% | 18일 | -87만원 |
| 2026-01-26 | CONL | macd_vol | 원본 | $14.50 | $10.50 | -27.6% | 10일 | -83만원 |
| 2026-01-29 | PTIR | macd_vol | 원본 | $27.71 | $19.10 | -31.1% | 22일 | -74만원 |
| 2026-01-30 | IREN | macd_vol | 보수적 | $57.82 | $53.74 | -7.1% | 14일 | -20만원 |
| 2026-01-30 | IREN | btc_rsi_e | 보수적 | $56.68 | $53.74 | -5.2% | 7일 | -16만원 |
| 2026-02-05 | IREN | macd_vol | 원본 | $53.48 | $39.79 | -25.6% | 15일 | -77만원 |
| 2026-02-05 | IREN | btc_rsi_e | 원본 | $56.48 | $39.79 | -29.6% | 16일 | -151만원 |
| 2026-02-05 | IREN | strong25_macd | 원본 | $59.82 | $39.79 | -33.5% | 20일 | -171만원 |
| 2026-02-05 | IREN | strong25_macd | 보수적 | $52.12 | $39.79 | -23.7% | 31일 | -159만원 |

> 모든 OOS 거래가 손실 — 1월 고점권 진입 후 2월 급락 구간 전량 손절

### 4.4 OOS 분석: 왜 실패했는가

1. **신호 발생 타이밍 문제**: 모든 신호가 1월 상승 국면 말미(1/13~2/5)에 집중됨
   - IREN이 $42→$57로 34% 급등 → DI크로스+거래량+RSI 조건 충족 → 신호 발생
   - 그러나 이미 1월 중순이 고점이었음

2. **BTC RSI 상태**: 1월 5일 BTC RSI=73.4 (과열 신호) → J 실험 발견(BTC RSI<61 유리)에 반함
   - 보수적 `btc_rsi_e` (BTC RSI<64.6)는 IREN 신호를 대부분 필터링 → OOS 손실 최소화

3. **시장 구조**: 2026년 1-2월은 "매크로 하락 + 기술적 신호 혼선" 구간
   - 개별 종목은 강한 모멘텀을 보이지만 전반적 방향성은 하락
   - 어떤 모멘텀 전략도 이 구간을 이길 수 없음

---

## 5. 원본 vs 보수적 파라미터 비교 분석

### 5.1 PnL vs WR 트레이드오프

```
원본 파라미터 (T80/S-25/H90/3x/pyr3):
  ✅ 높은 Train PnL (2,457 ~ 6,258만원)
  ❌ 낮은 WR (35% ~ 66.7%)
  ❌ OOS에서 큰 손실 (손절 -25~-30% 발동)
  특징: 소수의 대형 수익(+80~140%)이 전체 PnL 견인

보수적 파라미터 (T36~54/S-11~22/H35~52/2.8~3x/pyr2~3):
  ❌ 낮은 Train PnL (1,653 ~ 4,726만원)
  ✅ 높은 WR (59.5% ~ 100%)
  ✅ OOS에서 작은 손실 (손절 -5~-24% 발동)
  특징: 더 많은 거래, 균일한 수익 분포
```

### 5.2 실전 운용 관점에서의 적합성

| 기준 | 원본 | 보수적 | 우위 |
|------|------|--------|------|
| 심리적 부담 | 높음 (손실 빈번) | 낮음 (WR 높음) | 보수적 |
| 자금 관리 | 큰 손절 (-25~30%) | 작은 손절 (-11~22%) | 보수적 |
| 거래 빈도 | 낮음 (연 8~15회) | 중간 (연 8~24회) | 보수적 |
| OOS 안정성 | 큰 손실 위험 | 소폭 손실 | 보수적 |
| 장기 수익 포텐셜 | 높음 (불마켓) | 중간 | 원본 |

---

## 6. 최적 파라미터 신호 분석

Optuna가 공통적으로 수렴한 핵심 신호 조건:

### 6.1 매크로 환경 필터

| 조건 | 원본 | 보수적 최적화 결과 | 의미 |
|------|------|-----------------|------|
| BTC RSI | btc_regime==2 | < 64~77 | BTC 과열 회피 |
| BTC MA20 위 | 필요 (regime2) | **불필요** (di_surge) | J 실험 확인 |
| VIX | 없음/넓음 | 12~32~38 | 극공포/탐욕 회피 |

> **핵심 발견**: `btc_above_ma20=False` (di_surge 보수적) — BTC가 MA20 아래에 있어도 진입 가능. J 실험의 "btc_regime 0에서도 WR 81.6%" 발견과 일치.

### 6.2 종목 조건

| 조건 | 원본 | 보수적 최적화 결과 |
|------|------|-----------------|
| pct_ma20 | 없음 | +1.6 ~ +12.8% |
| 급등 (ret1) | >3% | >1.5~6.0% |
| 거래량비율 | 없음 | >0.6~2.3x |
| RSI14 | >55 (일부) | >10~68.8 |
| DI 갭 | >0 | >3.6~10.1 |

> **btc_rsi_e 보수적**: surge_pct=5.96% → 당일 6% 이상 급등일만 진입. 매우 강한 필터

### 6.3 청산 조건 수렴

| 파라미터 | 원본 | 보수적 (범위) | 적정 기준 |
|---------|------|------------|---------|
| target_pct | 80% | 36~54% | **40~55%** |
| stop_pct | -25% | -11~-22% | **-12~-20%** |
| hold_days | 90일 | 35~52일 | **40~55일** |
| unit_mul | 3.0x | 2.8~3.0x | **2.5~3.0x** |
| max_pyramid | 3층 | 2~3층 | **2층** |

---

## 7. 최종 권장 전략

### 7.1 배포 추천: `btc_rsi_e` 보수적 최적화

**선택 근거**:
- Train WR 75% — IREN/CONL/PTIR 3종목 모두 동일한 75% (일관성 최고)
- N=24 거래 (연간 약 10회 — 통계적으로 의미 있는 수준)
- OOS 손실 최소 (-16만원 = 1건, -5.2%)
- BTC RSI<64.6 조건이 J 실험 발견과 가장 일치

**진입 신호 (확정)**:
```
AND 조건 (모두 충족해야 진입):
  1. BTC RSI14 < 64.6          ← 핵심: BTC 과열 아님
  2. DI+ - DI- ≥ 7.8           ← 방향성 확인
  3. 당일 상승률 ≥ 5.96%        ← 강한 매수세
  4. 종목 pct_MA20 ≥ 12.76%    ← 추세 내 위치
  5. 거래량비율 ≥ 1.42x         ← 거래량 확인
  6. VIX: 12.4 ~ 34.7          ← 극단 회피
```

**청산 규칙 (확정)**:
```
  목표 수익: +54.4%
  손절:     -11.0%
  최대 보유: 50일
  트레일링:  -8.0% (고점 대비)
  포지션:   3.0x, 2층 피라미딩 (+5.7% 상승 시 추가)
```

### 7.2 보조 전략: `macd_vol` 보수적

**선택 근거**:
- Train WR 78.9%, N=19
- `rsi14_min=68.78` — 오버바운드 모멘텀 전략으로 서로 다른 시장 국면 포착
- `btc_rsi_e`와 신호 발생 타이밍이 달라 앙상블 활용 가능

**핵심 차이**: `btc_rsi_e`는 강한 급등일(6%+) + BTC 냉각 구간 포착. `macd_vol`은 RSI14>68 모멘텀 가속 구간 포착.

### 7.3 앙상블 조건 (두 전략 동시 신호 = 최강)

```python
# 최강 진입: btc_rsi_e AND macd_vol 동시 충족
if btc_rsi_e_signal and macd_vol_signal:
    # 단위 포지션의 1.5배로 진입 (확신도 높음)
    enter_with_conviction()
```

---

## 8. 핵심 발견 요약

| 발견 | 내용 |
|------|------|
| **BTC RSI 역발상** | BTC RSI < 65 구간이 > 75보다 수익률 우위 (J 실험, Optuna 동시 확인) |
| **BTC regime보다 BTC RSI** | btc_above_ma20=False가 성능 향상 — BTC 추세 방향보다 과열 여부가 중요 |
| **VIX 극단 회피** | VIX < 12 또는 > 35 구간에서 성과 저조 |
| **강한 급등 필터** | 당일 6%+ 급등 조건이 WR 유지에 기여 (btc_rsi_e) |
| **OOS 1월~2월 2026** | 전략 문제가 아닌 시장 구조 문제 — 고점 신호 발생 후 급락 |
| **보수적 파라미터 우위** | T40~55%, S-11~22%, H40~52일이 실전에서 더 안정적 |
| **CONL 주의** | WR이 낮고 변동성이 커서 단독 운용 위험 — 포트폴리오 관점 필요 |

---

## 9. 부록: Train 구간 주요 거래 기록

### 9.1 btc_rsi_e 보수적 — IREN 주요 거래

| 날짜 | 진입가 | 청산가 | 수익% | 보유일 |
|------|--------|--------|-------|--------|
| 2023-12-07 | $3.64 | $5.81 | **+59.5%** | 13일 |
| 2024-06-12 | $8.34 | $13.55 | **+62.4%** | 9일 |
| 2025-07-03 | $10.42 | $16.82 | **+61.5%** | 27일 |
| 2025-09-24 | $30.19 | $47.14 | **+56.1%** | 15일 |
| 2024-04-02 | $6.47 | $5.89 | -9.0% | 1일 |
| 2025-07-28 | $16.95 | $16.58 | -2.2% | 21일 |

### 9.2 macd_vol 보수적 — IREN 주요 거래

| 날짜 | 진입가 | 청산가 | 수익% | 보유일 |
|------|--------|--------|-------|--------|
| 2025-09-15 | $25.56 | $37.14 | **+45.3%** | 18일 |
| 2024-06-06 | $7.36 | $10.27 | **+39.6%** | 17일 |
| 2023-12-27 | $6.91 | $9.56 | **+38.4%** | 14일 |
| 2025-07-17 | $12.93 | $18.05 | **+39.6%** | 22일 |
| 2024-10-31 | $10.90 | $9.12 | -16.3% | 3일 |

---

*보고서 생성: ptj_stock_lab experiments/exp_M_report_data.py*
*데이터: experiments/results/M_report_data.json*
